An example of code reduction (code duplication avoided). <br>
Pay attention to 7-10, 38 lines of script
